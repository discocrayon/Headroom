# Output Examples

## CLI Output

When you run Headroom, you'll see analysis results and recommendations:

```
$ python -m headroom --config sample_config.yaml

================================================================================
SCP/RCP PLACEMENT RECOMMENDATIONS
================================================================================

Check: deny_imds_v1_ec2
Recommended Level: ROOT
Affected Accounts: 4
Compliance: 100.0%
Reasoning: All accounts in organization have zero violations - safe to deploy at root level
----------------------------------------

Check: deny_sts_third_party_assumerole
Recommended Level: OU
Affected Target: Acme Acquisition OU (ou-xxxx-xxxxxxxx)
Affected Accounts: 2
Third-Party Accounts: 2
Reasoning: All accounts under this OU allow the same third-party accounts with no violations - safe for OU-level RCP
----------------------------------------
INFO:headroom.parse_results:SCP placement analysis completed
INFO:headroom.parse_results:RCP placement analysis completed
INFO:headroom.aws.organization:Found organization root: r-ab1c
INFO:headroom.terraform.generate_scps:Generated SCP Terraform file: test_environment/scps/root_scps.tf
INFO:headroom.terraform.generate_rcps:Generated RCP Terraform file: test_environment/rcps/acme_acquisition_ou_rcps.tf
```

## Generated Terraform Files

### SCP Configuration Example

**File**: `test_environment/scps/root_scps.tf`

```hcl
# Auto-generated SCP Terraform configuration for Organization Root
# Generated by Headroom based on compliance analysis

module "scps_root" {
  source = "../modules/scps"
  target_id = local.root_ou_id

  # EC2
  deny_imds_v1_ec2 = false

  # IAM
  deny_iam_user_creation = true
  allowed_iam_users = [
    "arn:aws:iam::${local.fort_knox_account_id}:user/service/github-actions",
    "arn:aws:iam::${local.security_tooling_account_id}:user/automation/cicd-deployer",
    "arn:aws:iam::${local.acme_co_account_id}:user/contractors/temp-contractor",
    "arn:aws:iam::${local.acme_co_account_id}:user/terraform-user",
    "arn:aws:iam::${local.shared_foo_bar_account_id}:user/legacy-developer",
  ]
}
```

**See**: [Full example in test_environment](https://github.com/discocrayon/Headroom/blob/main/test_environment/scps/root_scps.tf)

### RCP Configuration Example

**File**: `test_environment/rcps/acme_acquisition_ou_rcps.tf`

```hcl
# Auto-generated RCP Terraform configuration for Acme Acquisition OU
# Generated by Headroom based on IAM trust policy analysis
# Union of third-party accounts from all accounts in this OU

module "rcps_acme_acquisition_ou" {
  source = "../modules/rcps"
  target_id = local.top_level_acme_acquisition_ou_id

  # deny_sts_third_party_assumerole
  enforce_assume_role_org_identities = true
  deny_sts_third_party_assumerole_account_ids_allowlist = [
    "111111111111",
    "222222222222",
  ]
}
```

**See**: [Full example in test_environment](https://github.com/discocrayon/Headroom/blob/main/test_environment/rcps/acme_acquisition_ou_rcps.tf)

### Organization Data Source Example

**File**: `test_environment/scps/grab_org_info.tf`

```hcl
# Auto-generated organization data sources
# These locals provide account IDs for use in SCP/RCP configurations

data "aws_organizations_organization" "current" {}

data "aws_organizations_organizational_units" "root" {
  parent_id = data.aws_organizations_organization.current.roots[0].id
}

locals {
  root_ou_id = data.aws_organizations_organization.current.roots[0].id
  fort_knox_account_id = "111111111111"
  security_tooling_account_id = "222222222222"
  # ... additional account mappings
}
```

## JSON Results Examples

### SCP Check Result

**File**: `test_environment/headroom_results/scps/deny_imds_v1_ec2/production_account_111111111111.json`

```json
{
  "account_id": "111111111111",
  "account_name": "production_account",
  "check_name": "deny_imds_v1_ec2",
  "compliance_percentage": 100.0,
  "total_resources": 5,
  "violations": [],
  "compliant_resources": [
    {
      "instance_id": "i-1234567890abcdef0",
      "region": "us-east-1",
      "metadata_options": {
        "HttpTokens": "required"
      }
    }
  ],
  "exemptions": []
}
```

### RCP Check Result

**File**: `test_environment/headroom_results/rcps/deny_sts_third_party_assumerole/development_account_333333333333.json`

```json
{
  "account_id": "333333333333",
  "account_name": "development_account",
  "check_name": "deny_sts_third_party_assumerole",
  "third_party_accounts": [
    "444444444444",
    "555555555555"
  ],
  "roles_with_third_party_access": [
    {
      "role_name": "CrossAccountAccessRole",
      "role_arn": "arn:aws:iam::333333333333:role/CrossAccountAccessRole",
      "third_party_principals": [
        "arn:aws:iam::444444444444:root"
      ]
    }
  ],
  "wildcard_principals": []
}
```

## Directory Structure After Running

```
test_environment/
├── headroom_results/
│   ├── scps/
│   │   ├── deny_imds_v1_ec2/
│   │   │   ├── production_account_111111111111.json
│   │   │   ├── development_account_222222222222.json
│   │   │   └── ...
│   │   ├── deny_iam_user_creation/
│   │   ├── deny_eks_create_cluster_without_tag/
│   │   └── deny_rds_unencrypted/
│   └── rcps/
│       ├── deny_sts_third_party_assumerole/
│       ├── deny_s3_third_party_access/
│       ├── deny_aoss_third_party_access/
│       └── deny_ecr_third_party_access/
├── scps/
│   ├── grab_org_info.tf
│   ├── root_scps.tf
│   ├── production_ou_scps.tf
│   └── ...
└── rcps/
    ├── grab_org_info.tf
    ├── acme_acquisition_ou_rcps.tf
    └── ...
```

## Example Workflows

### Workflow 1: Initial Scan

```bash
# First run - creates baseline
python -m headroom --config config.yaml

# Review results
git diff test_environment/headroom_results/

# Commit results for tracking
git add test_environment/
git commit -m "Initial Headroom scan results"
```

### Workflow 2: Periodic Compliance Checks

```bash
# Run weekly/monthly
python -m headroom --config config.yaml

# Check for new violations
git diff test_environment/headroom_results/

# Review changes in Terraform
git diff test_environment/scps/
git diff test_environment/rcps/
```

### Workflow 3: Deploying Generated Policies

```bash
# Run Headroom
python -m headroom --config config.yaml

# Review generated Terraform
cd test_environment/scps
terraform plan

# Deploy SCPs
terraform apply

# Deploy RCPs
cd ../rcps
terraform plan
terraform apply
```

## More Examples

For complete working examples with full context, see:
- [test_environment/scps/](https://github.com/discocrayon/Headroom/tree/main/test_environment/scps) - All SCP Terraform
- [test_environment/rcps/](https://github.com/discocrayon/Headroom/tree/main/test_environment/rcps) - All RCP Terraform
- [test_environment/headroom_results/](https://github.com/discocrayon/Headroom/tree/main/test_environment/headroom_results) - All JSON results
